#summary DistoX on android
#labels Featured

== DISCLAIMER ==

This code is provided under GPL v.2 licence.
It as provided as it is, with no guarantee.
I do NOT take resoponsability for any loss of your data.

This software is VERY experimental and unstable.
If you plan to use it for a real cave survey,
you should be ready to use TopoLinux command line tools
to recover your data, in case something goes wrong.
I repeat: I do NOT take resoponsability for any loss
of your data.

== IMPORTANT NOTICE ==

TopoDroid v. 0.7.X uses the database "distox4.db".
TopoDroid v. 1.0.X uses the database "distox6.db".
The two databases have different table schema.


== COMPILE and INSTALL ==

To install the compiled app on a device, copy (or download) the latest apk on the
sdcard.

To compile the package you need an android SDK.
Edit the AndroidMakefile.xml to suit your device.
Then compile and install
{{{
   $ ant debug
   # adb install -r bin/DistoX-debug.apk
}}}

TopoDroid requires bluetooth, and cannot run on a droid emulator.
You need a real device.

On the first run TopoDroid creates the directory TopoDroid,
wher it puts its subdirectories, and makes an empty database.
Your data will be saved here and will not be erased when you uninstall the app.
You should download the data to your PC now and then, and clean them from the
Android.
Starting with v. 1.0 you can
delete all the data and files of a survey (or a calibration) from TopoDroid:
make a backup on a PC before deleting a survey.

The location of the base directory TopoDroid, can be set with the program
configuration options. By default it is placed in the "external storage". 

== HOWTO (v. 1.0)== 

When you start TopoDroid the first time you are presented with a greeting screen.
This will not show again; to see is select the "About" menu.
The main TopoDroid window shows the list of surveys or that of calibrations.
You can toggle between the two list by tapping the buttons on the top.

The main widow menus:
  * DistoX
  * New
  * Import
  * More (Help, Options, About)

The "DistoX" menu opens the Device window. With this you can manage DistoX:
list the paired devices, scan for new ones, reset TopoDroid BlueTooth.
TopoDroid connects to one device at a time: the current device can be changed by selecting a new one from the list of paired (or scanned) devices.
The name of the current DistoX device is displayed in the title bar, together with
the connection state.

The data transfer between the DistoX and TopoDroid can be continuous or on-demand. In the first case TopoDroid is continuously connected to the DistoX and this sends data to TopoDroid as soon as they are acquired. This connection may fail when the DistoX switches off, or gets too far away from the Android. TopoDroid detect such a failure (there is a timeout of 25 seconds), and turns the connection off if it happens. With the on-demand connection TopoDroid connects to the DistoX only when needed to fulfill a user request. Certain actions (toggling the DistoX in calibration mode, reading and writing the calibration coefficients) can be done only with the on-demand connection.

When a DistoX is connected the downloaded data go into the active survey or the active calibration depending on the type of the data.

The menu "New" creates a new survey/calibration. The menu "Import" is used to import an external Therion survey or a zip archive of a previous survey.

Tapping a survey in the list opens the Survey window. This displays the survey infos
(name, date, team, description) and a list of buttons:
  * Save: save any change to the info in the database
  * Open: opens the Shots window
  * Export: export the survey (available formats: Therion, Compass, VisualTopo, Survex)
  * Zip: creates a zip archive of the survey and all associated files
  * 3D: display the 3D
  * Notes: edit survey annotations
  * Location: manage fixed stations
  * Delete: delete the survey and all associated data and files


The Shots window displays the list of survey shots. There are three types of shots:
leg (white) with bot FROM and TO stations, splay (blue) with only FROM station, and blank (red) with no station. Groups of consecutive close shots are taken to make a centerline leg and usually only the first is displayed. The display of splay and blank shots can be turned off. Each shot is shown as
{{{
   id <from-to> distance compass clino [extend]
}}}

Station names can include digits and letters, as well as symbols.
To assign the stations to a shot tap on the shot and enter the stations in the shot dialog that appears. TopoDroid guesses the station names from those of the previous shot, so you have to make a change only if these are incorrect. Furthermore there is a menu (Survey|Number) to assign the FROM station to splay shots automatically, using that of the following leg.

The extend is one of '<' (left), '>' (right) or '|' vertical (enclosed in square brackets). The shot extend can be changed in the shot dialog.

An asterisk "`*`" follows the _extend_ if the shot is marked as "duplicate".
The duplicate flag can be toggled in the shot dialog.

With the shot dialog you can also add a brief note (comment) to the shot.

The "Scraps" menu lists the scraps of the current survey. Tapping on one of them opend the Drawing window.

On a scrap you can draw lines, areas, and points (speleo symbols). These are the analogue of the Therion lines, areas, and points. Currently only a few line, area, and point types are supported. 

Available point typesi (Nov. 2011):
  * air-draught (orientable)
  * anchor
  * blocks
  * clay
  * continuation
  * danger
  * debris
  * entrance (orientable)
  * flowstone
  * gradient (orientable)
  * ice
  * label (with text)
  * popcorn
  * sand
  * stal: either stalactite or stalagmite (it can be rotated by 180 degrees)
  * water
  * water-flow (orientable)

Available line types (Nov. 2011):
  * wall (red)
  * pit (pink)
  * chimney (dark pink)
  * arrow (white)
  * rock-border (gray)
  * border (green)

Available area type:
  * blocks (dark brown)
  * clay (dark green)
  * debris (brown)
  * ice (grey)
  * pebbels (green)
  * sand (green)
  * water (blue)

The buttons on the drawing window allow to
  * toggle between moving the canvas or drawing on it
  * undo the last drawn object
  * zoom in/out
  * select the point symbol
  * select the line type
  * select the area type

Additionally there are the menus
  * redo
  * save the plot (scrap) as therion th2 file
  * export the plot as PNG image
  * toggle display mode
  * stats
  * delete

With the "Calibs" tab of TopoDroid window you manage calibrations.
Selecting a calibration of the list, opens the Calibration window with the calibration info (name, date, device, description), and the buttons
  * Save
  * Open
  * Delete

Opening the calibration display the Calibration Data window.
The calibration data are displayed in the list as
{{{
   id <group> compass clino roll error
}}}
The group is used to define groups of data with the same direction: to assign
the group tap on the data line and edit the group name in the dialog.
The groups can be guessed with a menu in the "Calibs" option.
The calibration is computed with another menu in the "Calibs" option:
the calibration result is displayed, together with the average error,
and other infos. After the calibration has been computed it can be written
to the DistoX device.


The "Options" option allows to set some TopoDroid configuration options
and save them.
  * tolerance among centerline data to define a single shot
  * calibration minimum error
  * calibration maximum number of iterations
  * tolerance among calibration data to belong to the same group

== FURTHER DOCS ==

[TopoDroidTips TopoDroid Tips]

[TopoDroidFAQ TopoDroid FAQ]

[TopoDroidTroubleshooting TopoDroid Troubleshooting]

[TopoDroidDevices TopoDroid Working devices]

[TopoDroidDB TopoDroid DB]

... adn the PDF docs in the download section.

== BUGS REPORT ==

If you have a crash or the app does not work as expected, please send me
a logcat-dump. To generate a logcat-dump, connect a desktop with Android SDK
to yout device and run "adb logcat | grep DistoX".


If you discover a bug or a problem please file an issue on this site.

If you have comments and suggestions feel free to drop me an email: 
marco dot corvi at gmail dot com